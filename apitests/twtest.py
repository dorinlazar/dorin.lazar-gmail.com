import json
import yaml
import os
import twitter


def get_tweets(api=None, screen_name=None):
  timeline = api.GetUserTimeline(screen_name=screen_name, count=10)
  earliest_tweet = min(timeline, key=lambda x: x.id).id
  return timeline
  # print("getting tweets before:", earliest_tweet)

  # while True:
  #   tweets = api.GetUserTimeline(
  #       screen_name=screen_name, max_id=earliest_tweet, count=200
  #   )
  #   new_earliest = min(tweets, key=lambda x: x.id).id

  #   if not tweets or new_earliest == earliest_tweet:
  #     break
  #   else:
  #     earliest_tweet = new_earliest
  #     print("getting tweets before:", earliest_tweet)
  #     timeline += tweets

  # return timeline


if __name__ == "__main__":
  with open(os.path.expanduser('~/.robotnik.yml'), 'r') as ymlfile:
    cfg = yaml.load(ymlfile, Loader=yaml.FullLoader)
  tw = cfg['twitter']
  api = twitter.Api(
      tw['ck'], tw['cks'], tw['at'], tw['ats']
  )
  timeline = get_tweets(api=api, screen_name='dorinlazar')

  for tweet in timeline:
    if tweet.retweeted:
      print('retweeted status: https://twitter.com/{}/status/{}'.format(tweet.retweeted_status.user.screen_name,
            tweet.retweeted_status.id))
      # print(json.dumps(tweet._json))


# {"created_at": "Fri Feb 18 14:34:41 +0000 2022", "id": 1494681782544789507, "id_str": "1494681782544789507", "text": "RT @MaggieAstor: At the 2000 Olympics, Andreea Raducan was stripped of her all-around gold medal because she woke up with a cold and the Ro\u2026", "truncated": false, "entities": {"hashtags": [], "symbols": [], "user_mentions": [{"screen_name": "MaggieAstor", "name": "Maggie Astor", "id": 326562333, "id_str": "326562333", "indices": [3, 15]}], "urls": []}, "source": "<a href=\"http://twitter.com/download/android\" rel=\"nofollow\">Twitter for Android</a>", "in_reply_to_status_id": null, "in_reply_to_status_id_str": null, "in_reply_to_user_id": null, "in_reply_to_user_id_str": null, "in_reply_to_screen_name": null, "user": {"id": 23897807, "id_str": "23897807", "name": "Mihai Maruseac", "screen_name": "mihaimaruseac", "location": "Mountain View, CA", "description": "At Google making tensors flow safely.\n\nPreviously at startup making ML algos be differentially private.\n\nWriting Haskell for fun when I get time.", "url": null, "entities": {"description": {"urls": []}}, "protected": false, "followers_count": 1158, "friends_count": 1001, "listed_count": 27, "created_at": "Thu Mar 12 04:27:52 +0000 2009", "favourites_count": 50199, "utc_offset": null, "time_zone": null, "geo_enabled": true, "verified": false, "statuses_count": 11014, "lang": null, "contributors_enabled": false, "is_translator": false, "is_translation_enabled": false, "profile_background_color": "131516", "profile_background_image_url": "http://abs.twimg.com/images/themes/theme14/bg.gif", "profile_background_image_url_https": "https://abs.twimg.com/images/themes/theme14/bg.gif", "profile_background_tile": true, "profile_image_url": "http://pbs.twimg.com/profile_images/1306795040019066881/ftp-sYVp_normal.jpg", "profile_image_url_https": "https://pbs.twimg.com/profile_images/1306795040019066881/ftp-sYVp_normal.jpg", "profile_banner_url": "https://pbs.twimg.com/profile_banners/23897807/1440197215", "profile_link_color": "ABB8C2", "profile_sidebar_border_color": "EEEEEE", "profile_sidebar_fill_color": "EFEFEF", "profile_text_color": "333333", "profile_use_background_image": false, "has_extended_profile": true, "default_profile": false, "default_profile_image": false, "following": true, "follow_request_sent": false, "notifications": false, "translator_type": "none", "withheld_in_countries": []}, "geo": null, "coordinates": null, "place": null, "contributors": null, "retweeted_status": {"created_at": "Wed Feb 16 01:27:01 +0000 2022", "id": 1493758783851417605, "id_str": "1493758783851417605", "text": "At the 2000 Olympics, Andreea Raducan was stripped of her all-around gold medal because she woke up with a cold and\u2026 https://t.co/eR61K6yKI2", "truncated": true, "entities": {"hashtags": [], "symbols": [], "user_mentions": [], "urls": [{"url": "https://t.co/eR61K6yKI2", "expanded_url": "https://twitter.com/i/web/status/1493758783851417605", "display_url": "twitter.com/i/web/status/1\u2026", "indices": [117, 140]}]}, "source": "<a href=\"https://mobile.twitter.com\" rel=\"nofollow\">Twitter Web App</a>", "in_reply_to_status_id": null, "in_reply_to_status_id_str": null, "in_reply_to_user_id": null, "in_reply_to_user_id_str": null, "in_reply_to_screen_name": null, "user": {"id": 326562333, "id_str": "326562333", "name": "Maggie Astor", "screen_name": "MaggieAstor", "location": "New York, N.Y.", "description": "Reporter @nytimes, politics/covid/live news/a bit of everything. Stay for cat photos and gymnastics. Not one of those Astors. She/her, maggie.astor@nytimes.com.", "url": "https://t.co/u61fWoOGKS", "entities": {"url": {"urls": [{"url": "https://t.co/u61fWoOGKS", "expanded_url": "https://www.nytimes.com/by/maggie-astor", "display_url": "nytimes.com/by/maggie-astor", "indices": [0, 23]}]}, "description": {"urls": []}}, "protected": false, "followers_count": 21080, "friends_count": 1518, "listed_count": 413, "created_at": "Thu Jun 30 03:36:13 +0000 2011", "favourites_count": 4053, "utc_offset": null, "time_zone": null, "geo_enabled": false, "verified": true, "statuses_count": 7742, "lang": null, "contributors_enabled": false, "is_translator": false, "is_translation_enabled": false, "profile_background_color": "C0DEED", "profile_background_image_url": "http://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_image_url_https": "https://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_tile": false, "profile_image_url": "http://pbs.twimg.com/profile_images/1280172404506087424/qmeNwwMm_normal.jpg", "profile_image_url_https": "https://pbs.twimg.com/profile_images/1280172404506087424/qmeNwwMm_normal.jpg", "profile_banner_url": "https://pbs.twimg.com/profile_banners/326562333/1547161725", "profile_link_color": "1DA1F2", "profile_sidebar_border_color": "C0DEED", "profile_sidebar_fill_color": "DDEEF6", "profile_text_color": "333333", "profile_use_background_image": true, "has_extended_profile": true, "default_profile": true, "default_profile_image": false, "following": false, "follow_request_sent": false, "notifications": false, "translator_type": "none", "withheld_in_countries": []}, "geo": null, "coordinates": null, "place": null, "contributors": null, "is_quote_status": false, "retweet_count": 94, "favorite_count": 384, "favorited": true, "retweeted": true, "possibly_sensitive": false, "lang": "en"}, "is_quote_status": false, "retweet_count": 94, "favorite_count": 0, "favorited": true, "retweeted": true, "lang": "en"}

# {"created_at": "Sat Feb 19 01:50:23 +0000 2022", "id": 1494851828772745219, "id_str": "1494851828772745219", "text": "RT @Odoamne: Stay mad kids https://t.co/9MDpq0HHIx", "truncated": false, "entities": {"hashtags": [], "symbols": [], "user_mentions": [{"screen_name": "Odoamne", "name": "Andrei Pascu", "id": 2274984734, "id_str": "2274984734", "indices": [3, 11]}], "urls": [{"url": "https://t.co/9MDpq0HHIx", "expanded_url": "https://twitter.com/lec/status/1494798551402135561", "display_url": "twitter.com/lec/status/149\u2026", "indices": [27, 50]}]}, "source": "<a href=\"https://about.twitter.com/products/tweetdeck\" rel=\"nofollow\">TweetDeck</a>", "in_reply_to_status_id": null, "in_reply_to_status_id_str": null, "in_reply_to_user_id": null, "in_reply_to_user_id_str": null, "in_reply_to_screen_name": null, "user": {"id": 64694244, "id_str": "64694244", "name": "Dorin Laz\u0103r", "screen_name": "dorinlazar", "location": "Rom\u00e2nia", "description": "Tall beardless dwarf, developer, aspiring writer, proudly mediocre.\n: blogger@ https://t.co/YzpO4fKwAU\n: podcaster@ https://t.co/lsOumO6aS9 & https://t.co/UkzKRSrUxL", "url": "https://t.co/kZo8imkT1r", "entities": {"url": {"urls": [{"url": "https://t.co/kZo8imkT1r", "expanded_url": "https://dorinlazar.ro/", "display_url": "dorinlazar.ro", "indices": [0, 23]}]}, "description": {"urls": [{"url": "https://t.co/YzpO4fKwAU", "expanded_url": "http://dorinlazar.ro", "display_url": "dorinlazar.ro", "indices": [79, 102]}, {"url": "https://t.co/lsOumO6aS9", "expanded_url": "http://podcastdeistorie.ro", "display_url": "podcastdeistorie.ro", "indices": [116, 139]}, {"url": "https://t.co/UkzKRSrUxL", "expanded_url": "http://icrpodcast.ro", "display_url": "icrpodcast.ro", "indices": [142, 165]}]}}, "protected": false, "followers_count": 1541, "friends_count": 608, "listed_count": 42, "created_at": "Tue Aug 11 11:59:17 +0000 2009", "favourites_count": 13012, "utc_offset": null, "time_zone": null, "geo_enabled": false, "verified": false, "statuses_count": 28446, "lang": null, "contributors_enabled": false, "is_translator": false, "is_translation_enabled": false, "profile_background_color": "C0DEED", "profile_background_image_url": "http://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_image_url_https": "https://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_tile": false, "profile_image_url": "http://pbs.twimg.com/profile_images/1199258941894676481/H2EHaFjP_normal.jpg", "profile_image_url_https": "https://pbs.twimg.com/profile_images/1199258941894676481/H2EHaFjP_normal.jpg", "profile_banner_url": "https://pbs.twimg.com/profile_banners/64694244/1404359309", "profile_link_color": "1DA1F2", "profile_sidebar_border_color": "C0DEED", "profile_sidebar_fill_color": "DDEEF6", "profile_text_color": "333333", "profile_use_background_image": true, "has_extended_profile": false, "default_profile": true, "default_profile_image": false, "following": false, "follow_request_sent": false, "notifications": false, "translator_type": "none", "withheld_in_countries": []}, "geo": null, "coordinates": null, "place": null, "contributors": null, "retweeted_status": {"created_at": "Fri Feb 18 22:33:09 +0000 2022", "id": 1494802193391755268, "id_str": "1494802193391755268", "text": "Stay mad kids https://t.co/9MDpq0HHIx", "truncated": false, "entities": {"hashtags": [], "symbols": [], "user_mentions": [], "urls": [{"url": "https://t.co/9MDpq0HHIx", "expanded_url": "https://twitter.com/lec/status/1494798551402135561", "display_url": "twitter.com/lec/status/149\u2026", "indices": [14, 37]}]}, "source": "<a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\">Twitter for iPhone</a>", "in_reply_to_status_id": null, "in_reply_to_status_id_str": null, "in_reply_to_user_id": null, "in_reply_to_user_id_str": null, "in_reply_to_screen_name": null, "user": {"id": 2274984734, "id_str": "2274984734", "name": "Andrei Pascu", "screen_name": "Odoamne", "location": "Berlin, Germany", "description": "League of Legends professional top laner. Business inquiries: rich@theblacklodge.uk & odoamnepascu@gmail.com \ud83c\uddf7\ud83c\uddf4", "url": "https://t.co/kv1s6HqqHp", "entities": {"url": {"urls": [{"url": "https://t.co/kv1s6HqqHp", "expanded_url": "http://Instagram.com/odoamnelol", "display_url": "Instagram.com/odoamnelol", "indices": [0, 23]}]}, "description": {"urls": []}}, "protected": false, "followers_count": 83579, "friends_count": 201, "listed_count": 347, "created_at": "Fri Jan 03 19:35:10 +0000 2014", "favourites_count": 1746, "utc_offset": null, "time_zone": null, "geo_enabled": true, "verified": true, "statuses_count": 5274, "lang": null, "contributors_enabled": false, "is_translator": false, "is_translation_enabled": false, "profile_background_color": "C0DEED", "profile_background_image_url": "http://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_image_url_https": "https://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_tile": false, "profile_image_url": "http://pbs.twimg.com/profile_images/1346124437956022273/V-13jvqm_normal.jpg", "profile_image_url_https": "https://pbs.twimg.com/profile_images/1346124437956022273/V-13jvqm_normal.jpg", "profile_banner_url": "https://pbs.twimg.com/profile_banners/2274984734/1642025515", "profile_link_color": "0084B4", "profile_sidebar_border_color": "FFFFFF", "profile_sidebar_fill_color": "DDEEF6", "profile_text_color": "333333", "profile_use_background_image": false, "has_extended_profile": true, "default_profile": false, "default_profile_image": false, "following": true, "follow_request_sent": false, "notifications": false, "translator_type": "none", "withheld_in_countries": []}, "geo": null, "coordinates": null, "place": null, "contributors": null, "is_quote_status": true, "quoted_status_id": 1494798551402135561, "quoted_status_id_str": "1494798551402135561", "quoted_status": {"created_at": "Fri Feb 18 22:18:41 +0000 2022", "id": 1494798551402135561, "id_str": "1494798551402135561", "text": "? https://t.co/RtirJ4cLHN", "truncated": false, "entities": {"hashtags": [], "symbols": [], "user_mentions": [], "urls": [], "media": [{"id": 1494798357218435073, "id_str": "1494798357218435073", "indices": [2, 25], "media_url": "http://pbs.twimg.com/media/FL6XL6TXoAEMHxS.jpg", "media_url_https": "https://pbs.twimg.com/media/FL6XL6TXoAEMHxS.jpg", "url": "https://t.co/RtirJ4cLHN", "display_url": "pic.twitter.com/RtirJ4cLHN", "expanded_url": "https://twitter.com/LEC/status/1494798551402135561/photo/1", "type": "photo", "sizes": {"thumb": {"w": 150, "h": 150, "resize": "crop"}, "small": {"w": 680, "h": 442, "resize": "fit"}, "medium": {"w": 1047, "h": 681, "resize": "fit"}, "large": {"w": 1047, "h": 681, "resize": "fit"}}}]}, "extended_entities": {"media": [{"id": 1494798357218435073, "id_str": "1494798357218435073", "indices": [2, 25], "media_url": "http://pbs.twimg.com/media/FL6XL6TXoAEMHxS.jpg", "media_url_https": "https://pbs.twimg.com/media/FL6XL6TXoAEMHxS.jpg", "url": "https://t.co/RtirJ4cLHN", "display_url": "pic.twitter.com/RtirJ4cLHN", "expanded_url": "https://twitter.com/LEC/status/1494798551402135561/photo/1", "type": "photo", "sizes": {"thumb": {"w": 150, "h": 150, "resize": "crop"}, "small": {"w": 680, "h": 442, "resize": "fit"}, "medium": {"w": 1047, "h": 681, "resize": "fit"}, "large": {"w": 1047, "h": 681, "resize": "fit"}}}]}, "source": "<a href=\"https://mobile.twitter.com\" rel=\"nofollow\">Twitter Web App</a>", "in_reply_to_status_id": null, "in_reply_to_status_id_str": null, "in_reply_to_user_id": null, "in_reply_to_user_id_str": null, "in_reply_to_screen_name": null, "user": {"id": 1076110847947300865, "id_str": "1076110847947300865", "name": "LEC", "screen_name": "LEC", "location": "EU", "description": "Official Account of the League of Legends European Championship! #LEC", "url": "https://t.co/ipLRVVtdx2", "entities": {"url": {"urls": [{"url": "https://t.co/ipLRVVtdx2", "expanded_url": "http://eu.lolesports.com", "display_url": "eu.lolesports.com", "indices": [0, 23]}]}, "description": {"urls": []}}, "protected": false, "followers_count": 409735, "friends_count": 235, "listed_count": 904, "created_at": "Fri Dec 21 13:43:14 +0000 2018", "favourites_count": 3440, "utc_offset": null, "time_zone": null, "geo_enabled": false, "verified": true, "statuses_count": 7260, "lang": null, "contributors_enabled": false, "is_translator": false, "is_translation_enabled": false, "profile_background_color": "000000", "profile_background_image_url": "http://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_image_url_https": "https://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_tile": false, "profile_image_url": "http://pbs.twimg.com/profile_images/1461646295899197441/ZPd83yGa_normal.png", "profile_image_url_https": "https://pbs.twimg.com/profile_images/1461646295899197441/ZPd83yGa_normal.png", "profile_banner_url": "https://pbs.twimg.com/profile_banners/1076110847947300865/1642432824", "profile_link_color": "FF5117", "profile_sidebar_border_color": "000000", "profile_sidebar_fill_color": "000000", "profile_text_color": "000000", "profile_use_background_image": false, "has_extended_profile": false, "default_profile": false, "default_profile_image": false, "following": true, "follow_request_sent": false, "notifications": false, "translator_type": "none", "withheld_in_countries": []}, "geo": null, "coordinates": null, "place": null, "contributors": null, "is_quote_status": false, "retweet_count": 104, "favorite_count": 5449, "favorited": false, "retweeted": false, "possibly_sensitive": false, "lang": "und"}, "retweet_count": 52, "favorite_count": 2408, "favorited": true, "retweeted": true, "possibly_sensitive": false, "lang": "en"}, "is_quote_status": true, "quoted_status_id": 1494798551402135561, "quoted_status_id_str": "1494798551402135561", "retweet_count": 52, "favorite_count": 0, "favorited": true, "retweeted": true, "possibly_sensitive": false, "lang": "en"}
